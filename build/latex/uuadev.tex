%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[a4paper,11pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{xeCJK}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]


\usepackage[Sonny]{fncychap}
\ChNameVar{\Large\normalfont\sffamily}
\ChTitleVar{\Large\normalfont\sffamily}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}


\usepackage{xeCJK}
\setCJKmainfont[BoldFont=STZhongsong, ItalicFont=STKaiti]{STSong}
\setCJKsansfont[BoldFont=STHeiti]{STXihei}
\setCJKmonofont{STFangsong}
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt
\parindent 2em
\definecolor{VerbatimColor}{rgb}{0.95,0.95,0.95}
\setcounter{tocdepth}{3}
\renewcommand\familydefault{\ttdefault}
\renewcommand\CJKfamilydefault{\CJKrmdefault}


\title{uua dev}
\date{2020 年 10 月 16 日}
\release{0.1}
\author{cj.zhao}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{发布}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{简介}
\label{\detokenize{intro:id1}}\label{\detokenize{intro::doc}}
天诚社交中台开发文档

本文档适用于基于天诚移动中台进行应用开发的开发人员


\chapter{开发指南}
\label{\detokenize{dev-guide:id1}}\label{\detokenize{dev-guide::doc}}

\section{术语}
\label{\detokenize{dev-guide:id2}}\begin{itemize}
\item {} 
clientId：每个应用都有唯一的clientId，是基于移动社交中台进行应用开发的唯一应用标识。

\item {} 
secret：secret是应用里面用于保障数据安全的“钥匙”，每一个应用都有一个独立的访问密钥，为了保证数据的安全。

\item {} 
access\_token：access\_token是应用去移动社交中台获取信息时的重要票据，所有接口在通信时都需要携带此信息用于验证接口的访问权限。

\item {} 
realm: 租户，适用于一个系统支持多套用户体系。

\end{itemize}


\section{开始开发}
\label{\detokenize{dev-guide:id3}}

\chapter{开放认证}
\label{\detokenize{auth:id1}}\label{\detokenize{auth::doc}}

\section{OAuth2.0授权（WEB）}
\label{\detokenize{auth:oauth2-0-web}}

\subsection{场景说明}
\label{\detokenize{auth:id2}}
OAuth2是基于统一用户中心进行应用开发的用户认证方式，目前统一认证中心打通了企业微信、钉钉等第三方用户认证方式，应用开发商不需要关心应用运行环境造成的认证方式不同，只需要基于统一用户中心OAuth2协议进行开发即可适配不同的移动社交平台。

通过此接口获取成员身份会有一定的时间开销。对于频繁获取成员身份的场景，建议采用如下方案：
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
应用开发商使用自己的token或cookie机制保存应用登录状态。

\item {} 
如果没有匹配的token或cookie，则重定向到统一用户中心OAuth验证链接，获取成员的身份信息后，由应用后台自己颁发token或cookie到客户端，用于识别当前登录用户身份。

\end{enumerate}


\subsection{授权流程}
\label{\detokenize{auth:id3}}

\subsubsection{获取code}
\label{\detokenize{auth:code}}
应用判断用户未登录后，构造如下的连接来获取code:

https://统一用户中心IP/realms/\{realm\sphinxhyphen{}name\}/protocol/openid\sphinxhyphen{}connect/auth?response\_type=code\&client\_id=CLIENT\_ID\&
redirect\_uri=CALLBACK\_URL\&scope=openid\&kc\_idp\_hint=wechat\sphinxhyphen{}work\&state=STATE

参数说明：



应用确认授权信息后，页面将跳转至 redirect\_uri?code=CODE\&state=STATE，应用可根据code参数获得access\_token。


\subsubsection{获取access\_token}
\label{\detokenize{auth:access-token}}
应用拿到code后，使用code换到access\_token，向下面的连接发送POST请求：

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{POST} \PYG{n}{https}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{统一用户中心IP}\PYG{o}{/}\PYG{n}{realms}\PYG{o}{/}\PYG{p}{\PYGZob{}}\PYG{n}{realm}\PYG{o}{\PYGZhy{}}\PYG{n}{name}\PYG{p}{\PYGZcb{}}\PYG{o}{/}\PYG{n}{protocol}\PYG{o}{/}\PYG{n}{openid}\PYG{o}{\PYGZhy{}}\PYG{n}{connect}\PYG{o}{/}\PYG{n}{token}
\PYG{n}{Content}\PYG{o}{\PYGZhy{}}\PYG{n}{Type}\PYG{p}{:} \PYG{n}{application}\PYG{o}{/}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{www}\PYG{o}{\PYGZhy{}}\PYG{n}{form}\PYG{o}{\PYGZhy{}}\PYG{n}{urlencoded}

\PYG{n}{grant\PYGZus{}type}\PYG{o}{=}\PYG{n}{authorization\PYGZus{}code}\PYG{o}{\PYGZam{}}\PYG{n}{client\PYGZus{}id}\PYG{o}{=}\PYG{n}{YOUR\PYGZus{}CLIENT\PYGZus{}ID}\PYG{o}{\PYGZam{}}\PYG{n}{client\PYGZus{}secret}\PYG{o}{=}\PYG{n}{YOUR\PYGZus{}CLIENT\PYGZus{}SECRET}\PYG{o}{\PYGZam{}}\PYG{n}{code}\PYG{o}{=}\PYG{n}{AUTHORIZATION\PYGZus{}CODE}\PYG{o}{\PYGZam{}}\PYG{n}{redirect\PYGZus{}uri}\PYG{o}{=}\PYG{n}{REDIRECT\PYGZus{}URI}
\end{sphinxVerbatim}

参数说明：



返回值：

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{HTTP}\PYG{o}{/}\PYG{l+m+mf}{1.1} \PYG{l+m+mi}{200} \PYG{n}{OK}
\PYG{n}{Content}\PYG{o}{\PYGZhy{}}\PYG{n}{Type}\PYG{p}{:} \PYG{n}{application}\PYG{o}{/}\PYG{n}{json}
\PYG{p}{\PYGZob{}}
  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{access\PYGZus{}token}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{eyJz93a...k4laUWw}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{refresh\PYGZus{}token}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GEbRxBN...edjnXbL}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{id\PYGZus{}token}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{eyJ0XAi...4faeEoQ}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{token\PYGZus{}type}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Bearer}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{expires\PYGZus{}in}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{86400}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsubsection{获取用户信息}
\label{\detokenize{auth:id4}}
发送下面的HTTP请求获取用户信息

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{GET} \PYG{n}{https}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{统一用户中心IP}\PYG{o}{/}\PYG{n}{realms}\PYG{o}{/}\PYG{p}{\PYGZob{}}\PYG{n}{realm}\PYG{o}{\PYGZhy{}}\PYG{n}{name}\PYG{p}{\PYGZcb{}}\PYG{o}{/}\PYG{n}{protocol}\PYG{o}{/}\PYG{n}{openid}\PYG{o}{\PYGZhy{}}\PYG{n}{connect}\PYG{o}{/}\PYG{n}{userinfo}
\PYG{n}{Authorization}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Bearer }\PYG{l+s+si}{\PYGZob{}ACCESS\PYGZus{}TOKEN\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

参数说明：
\begin{itemize}
\item {} 
ACCESS\_TOKEN 上一步中返回的access\_token

\end{itemize}

返回值：

\begin{sphinxVerbatim}[commandchars=\\\{\}]
  \PYG{n}{HTTP}\PYG{o}{/}\PYG{l+m+mf}{1.1} \PYG{l+m+mi}{200} \PYG{n}{OK}
  \PYG{n}{Content}\PYG{o}{\PYGZhy{}}\PYG{n}{Type}\PYG{p}{:} \PYG{n}{application}\PYG{o}{/}\PYG{n}{json}

  \PYG{p}{\PYGZob{}}
   \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sub}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{248289761001}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
   \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Jane Doe}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
   \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{given\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Jane}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
   \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{family\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Doe}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
   \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{preferred\PYGZus{}username}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{j.doe}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
   \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{email}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{janedoe@example.com}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
   \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{picture}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{http://example.com/janedoe/me.jpg}\PYG{l+s+s2}{\PYGZdq{}}
  \PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

返回值根据不同的应用，和用户授权scope会有差异。


\section{OAuth2.0授权（客户端）}
\label{\detokenize{auth:oauth2-0}}
此认证方式适用于C/S应用、小程序等场景。


\section{Spring boot集成}
\label{\detokenize{auth:spring-boot}}
统一用户中心支持直接与Spring boot应用集成，完成用户认证和资源访问控制功能。

增加如下依赖

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{dependency}\PYG{o}{\PYGZgt{}}
	\PYG{o}{\PYGZlt{}}\PYG{n}{groupId}\PYG{o}{\PYGZgt{}}\PYG{n}{org}\PYG{o}{.}\PYG{n}{springframework}\PYG{o}{.}\PYG{n}{boot}\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{groupId}\PYG{o}{\PYGZgt{}}
	\PYG{o}{\PYGZlt{}}\PYG{n}{artifactId}\PYG{o}{\PYGZgt{}}\PYG{n}{spring}\PYG{o}{\PYGZhy{}}\PYG{n}{boot}\PYG{o}{\PYGZhy{}}\PYG{n}{starter}\PYG{o}{\PYGZhy{}}\PYG{n}{security}\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{artifactId}\PYG{o}{\PYGZgt{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{dependency}\PYG{o}{\PYGZgt{}}
\PYG{o}{\PYGZlt{}}\PYG{n}{dependency}\PYG{o}{\PYGZgt{}}
    \PYG{o}{\PYGZlt{}}\PYG{n}{groupId}\PYG{o}{\PYGZgt{}}\PYG{n}{org}\PYG{o}{.}\PYG{n}{keycloak}\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{groupId}\PYG{o}{\PYGZgt{}}
    \PYG{o}{\PYGZlt{}}\PYG{n}{artifactId}\PYG{o}{\PYGZgt{}}\PYG{n}{keycloak}\PYG{o}{\PYGZhy{}}\PYG{n}{spring}\PYG{o}{\PYGZhy{}}\PYG{n}{boot}\PYG{o}{\PYGZhy{}}\PYG{n}{starter}\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{artifactId}\PYG{o}{\PYGZgt{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{dependency}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

在pom.xml中增加如下依赖管理配置：

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{dependencyManagement}\PYG{o}{\PYGZgt{}}
  \PYG{o}{\PYGZlt{}}\PYG{n}{dependencies}\PYG{o}{\PYGZgt{}}
    \PYG{o}{\PYGZlt{}}\PYG{n}{dependency}\PYG{o}{\PYGZgt{}}
      \PYG{o}{\PYGZlt{}}\PYG{n}{groupId}\PYG{o}{\PYGZgt{}}\PYG{n}{org}\PYG{o}{.}\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{bom}\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{groupId}\PYG{o}{\PYGZgt{}}
      \PYG{o}{\PYGZlt{}}\PYG{n}{artifactId}\PYG{o}{\PYGZgt{}}\PYG{n}{keycloak}\PYG{o}{\PYGZhy{}}\PYG{n}{adapter}\PYG{o}{\PYGZhy{}}\PYG{n}{bom}\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{artifactId}\PYG{o}{\PYGZgt{}}
      \PYG{o}{\PYGZlt{}}\PYG{n}{version}\PYG{o}{\PYGZgt{}}\PYG{l+m+mf}{11.0}\PYG{o}{.}\PYG{l+m+mi}{2}\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{version}\PYG{o}{\PYGZgt{}}
      \PYG{o}{\PYGZlt{}}\PYG{n+nb}{type}\PYG{o}{\PYGZgt{}}\PYG{n}{pom}\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n+nb}{type}\PYG{o}{\PYGZgt{}}
      \PYG{o}{\PYGZlt{}}\PYG{n}{scope}\PYG{o}{\PYGZgt{}}\PYG{n}{import}\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{scope}\PYG{o}{\PYGZgt{}}
    \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{dependency}\PYG{o}{\PYGZgt{}}
  \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{dependencies}\PYG{o}{\PYGZgt{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{dependencyManagement}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

在配置文件中增加如下配置：

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}认证服务器地址}
\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{auth}\PYG{o}{\PYGZhy{}}\PYG{n}{server}\PYG{o}{\PYGZhy{}}\PYG{n}{url}\PYG{o}{=}\PYG{n}{http}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{ide}\PYG{o}{.}\PYG{n}{gwunion}\PYG{o}{.}\PYG{n}{cn}\PYG{o}{/}\PYG{n}{auth}
\PYG{c+c1}{\PYGZsh{}租户名称}
\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{realm}\PYG{o}{=}\PYG{n}{vsapp}
\PYG{c+c1}{\PYGZsh{} ClientId}
\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{resource}\PYG{o}{=}\PYG{n}{testapp}
\PYG{c+c1}{\PYGZsh{} 非开放认证}
\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{public}\PYG{o}{\PYGZhy{}}\PYG{n}{client}\PYG{o}{=}\PYG{n}{false}
\PYG{c+c1}{\PYGZsh{} 使用应用角色}
\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{use}\PYG{o}{\PYGZhy{}}\PYG{n}{resource}\PYG{o}{\PYGZhy{}}\PYG{n}{role}\PYG{o}{\PYGZhy{}}\PYG{n}{mappings}\PYG{o}{=}\PYG{n}{true}
\PYG{c+c1}{\PYGZsh{} 应用secret}
\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{credentials}\PYG{o}{.}\PYG{n}{secret}\PYG{o}{=}\PYG{l+m+mi}{191}\PYG{n}{bad40}\PYG{o}{\PYGZhy{}}\PYG{n}{a2d6}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4252}\PYG{o}{\PYGZhy{}}\PYG{n}{be6f}\PYG{o}{\PYGZhy{}}\PYG{n}{a5869a4d2771}

\PYG{c+c1}{\PYGZsh{} 角色名称}
\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{security}\PYG{o}{\PYGZhy{}}\PYG{n}{constraints}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{authRoles}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{=}\PYG{n}{user}

\PYG{c+c1}{\PYGZsh{} 需要保护的资源}
\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{security}\PYG{o}{\PYGZhy{}}\PYG{n}{constraints}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{securityCollections}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{patterns}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{=}\PYG{o}{/}\PYG{n}{customers}\PYG{o}{/}\PYG{o}{*}
\PYG{n}{keycloak}\PYG{o}{.}\PYG{n}{principal}\PYG{o}{\PYGZhy{}}\PYG{n}{attribute}\PYG{o}{=}\PYG{n}{preferred\PYGZus{}username}
\end{sphinxVerbatim}


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{索引}
\printindex
\end{document}